
import L from "leaflet"
import { Dico } from "./types";


class Vecteur {

    x:number;
    y:number;
    
    constructor(x:number, y:number){
	this.x = x;
	this.y = y;
    }

    produitScalaire(autre_vecteur: Vecteur){
	return this.x*autre_vecteur.x + this.y*autre_vecteur.y;
    }
}



export class Lieu {

    static R_terre = 6360000; // en mètres
    static coeff_rad = Math.PI / 180; // Multiplier par ceci pour passer en radians

    coords: L.LatLng;
    infos: Dico = {};

    constructor(ll: L.LatLng, infos?:Dico) {
	this.coords = ll;
	if (infos){
	    this.infos = infos;
	}
    }

    ajouteMarqueur(carte: L.Map){
	L.marker(this.coords)
	.addTo(carte);
    }


    setLatlng(ll: L.LatLng){
	this.coords = ll;
    }

    // Renvoie un objet contenant uniquement les données utiles au serveur.
    // Remet les coords au format [lon, lat]
	// versDjango(){
	// 	const ll = this.getLatlng();
	// 	this.objet_initial.coords = [ll.lng, ll.lat];
	// 	return this.objet_initial;
	// }
	// 
    vecteurVers(autreLieu: Lieu){
	return this.vecteurVersLatLng(autreLieu.coords);
    }

    vecteurVersLatLng(ll2: L.LatLng){
	const ll1 = this.coords;
	const dx = Lieu.R_terre * Math.cos(ll1.lat*Math.PI/180) * (ll2.lng - ll1.lng)*Math.PI/180;
	const dy = Lieu.R_terre * (ll2.lat - ll1.lat)*Math.PI/180;
	return new Vecteur(dx, dy);
	}

}

